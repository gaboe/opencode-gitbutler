diff --git a/src/config.ts b/src/config.ts
index e8cdf0e..d8de9d9 100644
--- a/src/config.ts
+++ b/src/config.ts
@@ -62,16 +62,15 @@ export function stripJsonComments(input: string): string {
       continue;
     }
 
-    if (ch === "/" && input[i + 1] === "/") {
+    if (ch === "/" && i + 1 < len && input[i + 1] === "/") {
       i += 2;
       while (i < len && input[i] !== "\n") i++;
       continue;
     }
 
-    if (ch === "/" && input[i + 1] === "*") {
-      i += 2;
-      while (i < len && !(input[i] === "*" && input[i + 1] === "/")) i++;
-      i += 2;
+    if (ch === "/" && i + 1 < len && input[i + 1] === "*") {
+      const closeIdx = input.indexOf("*/", i + 2);
+      i = closeIdx !== -1 ? closeIdx + 2 : len;
       continue;
     }
 
diff --git a/src/plugin.ts b/src/plugin.ts
index c53d0fa..bb553ab 100644
--- a/src/plugin.ts
+++ b/src/plugin.ts
@@ -646,41 +646,48 @@ export function createGitButlerPlugin(
         const commit = branch.commits[0];
         if (!commit) continue;
 
-        const llmMessage = await generateLLMCommitMessage(
-          commit.commitId,
-          prompt
-        );
-        const commitMsg =
-          llmMessage ?? toCommitMessage(prompt);
-        butReword(commit.cliId, commitMsg);
-        rewordedBranches.add(branch.cliId);
-        savePluginState(
-          conversationsWithEdits,
-          rewordedBranches
-        ).catch(() => {});
-
-        addNotification(
-          sessionID,
-          `Commit on branch \`${branch.name}\` reworded to: "${commitMsg}"`
-        );
-
-        debugLog(cwd, "reword", {
-          branch: branch.name,
-          commit: commit.cliId,
-          message: commitMsg,
-          source: llmMessage ? "llm" : "deterministic",
-          multi: branch.commits.length > 1,
-        }).catch(() => {});
+        try {
+          const llmMessage = await generateLLMCommitMessage(
+            commit.commitId,
+            prompt
+          );
+          const commitMsg =
+            llmMessage ?? toCommitMessage(prompt);
+          butReword(commit.cliId, commitMsg);
+          rewordedBranches.add(branch.cliId);
+          savePluginState(
+            conversationsWithEdits,
+            rewordedBranches
+          ).catch(() => {});
 
-        if (DEFAULT_BRANCH_PATTERN.test(branch.name)) {
-          latestBranchName = toBranchSlug(prompt);
-          butReword(branch.cliId, latestBranchName);
           addNotification(
             sessionID,
-            `Branch renamed from \`${branch.name}\` to \`${latestBranchName}\``
+            `Commit on branch \`${branch.name}\` reworded to: "${commitMsg}"`
           );
-        } else {
-          latestBranchName = branch.name;
+
+          debugLog(cwd, "reword", {
+            branch: branch.name,
+            commit: commit.cliId,
+            message: commitMsg,
+            source: llmMessage ? "llm" : "deterministic",
+            multi: branch.commits.length > 1,
+          }).catch(() => {});
+
+          if (DEFAULT_BRANCH_PATTERN.test(branch.name)) {
+            latestBranchName = toBranchSlug(prompt);
+            butReword(branch.cliId, latestBranchName);
+            addNotification(
+              sessionID,
+              `Branch renamed from \`${branch.name}\` to \`${latestBranchName}\``
+            );
+          } else {
+            latestBranchName = branch.name;
+          }
+        } catch (err) {
+          debugLog(cwd, "reword-error", {
+            branch: branch.name,
+            error: err instanceof Error ? err.message : String(err),
+          }).catch(() => {});
         }
       }
     }
@@ -774,7 +781,7 @@ export function createGitButlerPlugin(
         ["but", "cursor", subcommand],
         {
           cwd,
-          stdout: "pipe",
+          stdout: "ignore",
           stderr: "pipe",
           stdin: new Blob([json]),
         }
@@ -1104,14 +1111,21 @@ export function createGitButlerPlugin(
           conversationId,
         }).catch(() => {});
 
-        await butCursor("after-edit", {
-          conversation_id: conversationId,
-          generation_id: crypto.randomUUID(),
-          file_path: relativePath,
-          edits: extractEdits(output),
-          hook_event_name: "afterFileEdit",
-          workspace_roots: [cwd],
-        });
+        try {
+          await butCursor("after-edit", {
+            conversation_id: conversationId,
+            generation_id: crypto.randomUUID(),
+            file_path: relativePath,
+            edits: extractEdits(output),
+            hook_event_name: "afterFileEdit",
+            workspace_roots: [cwd],
+          });
+        } catch (err) {
+          debugLog(cwd, "cursor-after-edit-error", {
+            file: relativePath,
+            error: err instanceof Error ? err.message : String(err),
+          }).catch(() => {});
+        }
 
         conversationsWithEdits.add(conversationId);
         savePluginState(
@@ -1185,13 +1199,20 @@ export function createGitButlerPlugin(
           conversationId,
         }).catch(() => {});
 
-        await butCursor("stop", {
-          conversation_id: conversationId,
-          generation_id: crypto.randomUUID(),
-          status: "completed",
-          hook_event_name: "stop",
-          workspace_roots: [cwd],
-        });
+        try {
+          await butCursor("stop", {
+            conversation_id: conversationId,
+            generation_id: crypto.randomUUID(),
+            status: "completed",
+            hook_event_name: "stop",
+            workspace_roots: [cwd],
+          });
+        } catch (err) {
+          debugLog(cwd, "cursor-stop-error", {
+            conversationId,
+            error: err instanceof Error ? err.message : String(err),
+          }).catch(() => {});
+        }
 
         await postStopProcessing(props?.sessionID);
       } finally {
